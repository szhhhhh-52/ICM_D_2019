floorN = 5;
W = 480;
L = 533;
peopleNum = 3000;
Louvre = zeros(W,L,floorN);


for i = 1:floorN
louvre = create_louvre(L,W,i);
Louvre(:,:,i) = louvre;
end

%exitList
load('exit.mat');
% [r,c] = size(exit);
% w = ones(r,1);
% exit = [exit w];
%  exit(:,end) = 4;

%stairsList
load('stairs.mat');

Louvre = initExit(Louvre,exit);
Louvre = initStairs(Louvre,stairs);

[phes,phesAdd] = initPhes(Louvre);%initPheromones = 1

[Louvre,peoples] = initPeople(Louvre,peopleNum);%peoples is the start of people location

for i = 1:floorN
h = show_plaza(Louvre(:,:,i),NaN,0.01);
end




iterations = 1;
for n = 1:iterations
    % introduce people
    num = peopleNum;
    
    %new Louvre
    
    % BUG!
%     if n>1
% %     for i = 1:floorN
% %     louvre = create_louvre(L,W,i);
% %     Louvre(:,:,i) = louvre;
%     for i = 1:peopleNum
%         Louvre(peoples(i,1),peoples(i,2),peoples(i,3)) = 0;
%     end
%     end

%     Louvre = initExit(Louvre,exit);
%     Louvre = initStairs(Louvre,stairs);
%     Louvre = initPeople(Louvre,num);
    
    for i = 1:1000
        temp = peoples;
        j = 0;
        while j<num
            [x,y,z,temp] = getPeople(temp);
            
            %judge
            
            %
            
            
    for i = 1:floorN
        h = show_plaza(Louvre(:,:,i),h,0.02);
    end
    

%     % update rules for lanes
%     [plaza, v, time] = switch_lanes(plaza, v, time); % lane changes
%     [plaza, v, time] = move_forward(plaza, v, time, vmax); % move cars forward
%     [plaza, v, time, departurescount, departurestime] = clear_boundary(plaza, v, time);
%     
%     % flux calculations
%     influx(i) = arrivalscount;
%     outflux(i) = departurescount;
%     timecost = [timecost, departurestime];
end






